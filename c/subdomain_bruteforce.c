#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <arpa/inet.h>
#include <netdb.h>

int main(int argc, char *argv[]){
    char *target;
    FILE *wordlist;
    
    char *result;
    char txt[225];

    struct hostent *host;

    if(argc!=3){
        printf("Usage: %s <domain> <wordlist>\n", argv[0]);
        printf("Example: %s domain.com file.txt\n", argv[0]);
    }
    else{
        target = argv[1];
        wordlist = fopen(argv[2], "r");
        while(fscanf(wordlist, "%s", &txt) != EOF){
            result = (char *) strcat(txt,target);
            host = gethostbyname(result);
            if(host == NULL){
                continue;
            }else{
                printf("Host found: %s => IP: %s\n", result, inet_ntoa(*((struct in_addr *)host->h_addr)));
            }
        }
    }
    return 0;
}